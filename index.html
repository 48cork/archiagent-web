<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ArchiAgent ‚Äî Assistente Inteligente para Arquitetos</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --terra: #2c1810; --terra-mid: #4a2c1a; --terra-light: #6b3f25;
    --gold: #c4933f; --gold-light: #e0b86a; --cream: #faf6f0;
    --cream-dark: #f0e8dc; --text: #1a1208; --text-mid: #4a3828;
    --text-light: #8a7060; --border: #d4c0a8; --white: #ffffff;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Source Serif 4', Georgia, serif; background: var(--cream); color: var(--text); min-height: 100vh; }
  #setup-screen { position: fixed; inset: 0; background: var(--terra); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 24px; }
  .setup-card { background: var(--cream); max-width: 520px; width: 100%; padding: 48px; text-align: center; }
  .setup-logo { font-family: 'Playfair Display', serif; font-size: 32px; color: var(--terra); margin-bottom: 4px; }
  .setup-sub { font-size: 11px; letter-spacing: 3px; color: var(--gold); text-transform: uppercase; margin-bottom: 32px; }
  .setup-divider { height: 1px; background: linear-gradient(90deg, transparent, var(--gold), transparent); margin: 24px 0; }
  .setup-card h2 { font-family: 'Playfair Display', serif; font-size: 20px; color: var(--terra); margin-bottom: 8px; }
  .setup-card p { font-size: 13px; color: var(--text-light); line-height: 1.7; margin-bottom: 24px; font-style: italic; }
  .setup-steps { text-align: left; background: var(--cream-dark); padding: 20px 24px; margin-bottom: 24px; }
  .setup-steps ol { padding-left: 20px; }
  .setup-steps li { font-size: 13px; color: var(--text-mid); margin-bottom: 8px; line-height: 1.6; }
  .setup-steps a { color: var(--gold); }
  .setup-input-wrap { position: relative; margin-bottom: 16px; }
  .setup-input-wrap input { width: 100%; padding: 14px 16px; border: 1px solid var(--border); font-family: 'Source Serif 4', serif; font-size: 14px; color: var(--text); background: var(--white); outline: none; }
  .setup-input-wrap input:focus { border-color: var(--gold); }
  .setup-input-wrap input::placeholder { color: var(--text-light); font-style: italic; }
  .btn-setup { width: 100%; padding: 16px; background: var(--terra); color: var(--white); border: none; font-family: 'Playfair Display', serif; font-size: 15px; font-weight: 600; cursor: pointer; letter-spacing: 1px; transition: background 0.2s; }
  .btn-setup:hover { background: var(--terra-mid); }
  .setup-note { font-size: 11px; color: var(--text-light); margin-top: 16px; line-height: 1.6; }
  #setup-error { color: #c0392b; font-size: 12px; margin-top: 8px; display: none; }
  #app { display: none; }
  .header { background: var(--terra); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 20px rgba(0,0,0,0.3); }
  .header-inner { max-width: 1100px; margin: 0 auto; padding: 18px 40px; display: flex; align-items: center; justify-content: space-between; }
  .logo { display: flex; align-items: center; gap: 16px; }
  .logo-mark { width: 44px; height: 44px; border: 2px solid var(--gold); display: flex; align-items: center; justify-content: center; font-family: 'Playfair Display', serif; font-size: 18px; color: var(--gold); font-weight: 700; }
  .logo-text h1 { font-family: 'Playfair Display', serif; font-size: 22px; color: var(--white); font-weight: 600; }
  .logo-text span { font-size: 11px; color: var(--gold); letter-spacing: 3px; text-transform: uppercase; font-weight: 300; }
  .header-right { display: flex; align-items: center; gap: 20px; }
  .api-status { font-size: 11px; color: #7ecfa0; letter-spacing: 1px; }
  .btn-change-key { font-size: 11px; color: var(--gold-light); background: none; border: 1px solid var(--terra-light); padding: 6px 12px; cursor: pointer; font-family: 'Source Serif 4', serif; letter-spacing: 1px; transition: border-color 0.2s; }
  .btn-change-key:hover { border-color: var(--gold); color: var(--gold); }
  .main { max-width: 1100px; margin: 0 auto; padding: 48px 40px; }
  .agents-nav { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 40px; }
  .agent-tab { background: var(--white); border: 1px solid var(--border); padding: 20px 16px; cursor: pointer; transition: all 0.2s; text-align: center; position: relative; overflow: hidden; }
  .agent-tab::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--gold); transform: scaleX(0); transition: transform 0.2s; }
  .agent-tab:hover::before, .agent-tab.active::before { transform: scaleX(1); }
  .agent-tab.active { background: var(--terra); border-color: var(--terra); }
  .agent-tab.active .agent-name, .agent-tab.active .agent-desc { color: var(--white); }
  .agent-tab.active .agent-icon { color: var(--gold); }
  .agent-icon { font-size: 24px; margin-bottom: 8px; display: block; }
  .agent-name { font-family: 'Playfair Display', serif; font-size: 14px; font-weight: 600; color: var(--terra); margin-bottom: 4px; }
  .agent-desc { font-size: 11px; color: var(--text-light); line-height: 1.4; font-weight: 300; }
  .panel { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; align-items: start; }
  .form-card, .result-card { background: var(--white); border: 1px solid var(--border); padding: 36px; animation: fade-in 0.3s ease; }
  .form-card h2 { font-family: 'Playfair Display', serif; font-size: 20px; color: var(--terra); margin-bottom: 6px; }
  .form-card .subtitle { font-size: 13px; color: var(--text-light); margin-bottom: 28px; font-weight: 300; font-style: italic; }
  .divider { height: 1px; background: linear-gradient(90deg, var(--gold) 0%, var(--border) 60%, transparent 100%); margin-bottom: 28px; }
  .form-group { margin-bottom: 20px; }
  label { display: block; font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-mid); margin-bottom: 8px; font-weight: 600; }
  input[type="text"], select, textarea { width: 100%; padding: 12px 16px; border: 1px solid var(--border); background: var(--cream); font-family: 'Source Serif 4', serif; font-size: 14px; color: var(--text); outline: none; transition: border-color 0.2s; appearance: none; }
  input[type="text"]:focus, select:focus, textarea:focus { border-color: var(--gold); background: var(--white); }
  textarea { resize: vertical; min-height: 100px; line-height: 1.6; }
  select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%234a3828' stroke-width='1.5' fill='none'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 14px center; padding-right: 36px; }
  .btn-generate { width: 100%; padding: 16px; background: var(--terra); color: var(--white); border: none; font-family: 'Playfair Display', serif; font-size: 15px; font-weight: 600; cursor: pointer; letter-spacing: 1px; transition: all 0.2s; margin-top: 8px; position: relative; overflow: hidden; }
  .btn-generate::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px; background: var(--gold); transform: scaleX(0); transition: transform 0.3s; }
  .btn-generate:hover::after { transform: scaleX(1); }
  .btn-generate:hover { background: var(--terra-mid); }
  .btn-generate:disabled { opacity: 0.6; cursor: not-allowed; }
  .result-card { min-height: 400px; display: flex; flex-direction: column; }
  .result-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
  .result-header h3 { font-family: 'Playfair Display', serif; font-size: 16px; color: var(--terra); font-weight: 600; }
  .result-actions { display: flex; gap: 8px; }
  .btn-action { padding: 7px 14px; border: 1px solid var(--border); background: transparent; font-size: 11px; letter-spacing: 1px; text-transform: uppercase; cursor: pointer; color: var(--text-mid); font-family: 'Source Serif 4', serif; transition: all 0.15s; }
  .btn-action:hover { border-color: var(--gold); color: var(--terra); }
  .result-content { flex: 1; font-size: 13.5px; line-height: 1.8; color: var(--text); white-space: pre-wrap; font-family: 'Source Serif 4', serif; font-weight: 300; }
  .result-placeholder { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-light); text-align: center; gap: 16px; }
  .result-placeholder .placeholder-icon { font-size: 48px; opacity: 0.3; }
  .result-placeholder p { font-size: 14px; font-style: italic; font-weight: 300; }
  .loading { display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; gap: 20px; }
  .loading-bars { display: flex; gap: 6px; align-items: flex-end; }
  .loading-bar { width: 4px; background: var(--gold); border-radius: 2px; animation: scale-bar 1.2s ease-in-out infinite; }
  .loading-bar:nth-child(1) { height: 20px; animation-delay: 0s; }
  .loading-bar:nth-child(2) { height: 32px; animation-delay: 0.15s; }
  .loading-bar:nth-child(3) { height: 24px; animation-delay: 0.3s; }
  .loading-bar:nth-child(4) { height: 36px; animation-delay: 0.45s; }
  .loading-bar:nth-child(5) { height: 20px; animation-delay: 0.6s; }
  @keyframes scale-bar { 0%, 100% { opacity: 0.3; transform: scaleY(0.6); } 50% { opacity: 1; transform: scaleY(1); } }
  .loading p { font-size: 13px; color: var(--text-light); font-style: italic; font-weight: 300; }
  .agent-panel { display: none; }
  .agent-panel.active { display: contents; }
  .footer { text-align: center; padding: 24px; font-size: 11px; color: var(--text-light); letter-spacing: 1px; border-top: 1px solid var(--border); margin-top: 40px; }
  @keyframes fade-in { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  @media (max-width: 768px) { .panel { grid-template-columns: 1fr; } .agents-nav { grid-template-columns: repeat(2, 1fr); } .main { padding: 24px 20px; } .header-inner { padding: 16px 20px; } }
</style>
</head>
<body>

<div id="setup-screen">
  <div class="setup-card">
    <div class="setup-logo">ArchiAgent</div>
    <div class="setup-sub">Assistente Inteligente para Arquitetos</div>
    <div class="setup-divider"></div>
    <h2>Configure sua Chave de API</h2>
    <p>Para usar o ArchiAgent voc√™ precisa de uma chave gratuita do Google Gemini. √â r√°pido e n√£o precisa de cart√£o de cr√©dito.</p>
    <div class="setup-steps">
      <ol>
        <li>Acesse <a href="https://aistudio.google.com" target="_blank">aistudio.google.com</a></li>
        <li>Fa√ßa login com sua conta Google</li>
        <li>Clique em <strong>Get API Key</strong> ‚Üí <strong>Create API Key</strong></li>
        <li>Copie a chave (come√ßa com <strong>AIza...</strong>) e cole abaixo</li>
      </ol>
    </div>
    <div class="setup-input-wrap">
      <input type="text" id="api-key-input" placeholder="AIzaSy..." autocomplete="off" />
    </div>
    <div id="setup-error">Chave inv√°lida. Verifique e tente novamente.</div>
    <button class="btn-setup" onclick="activateApp()">Entrar no ArchiAgent ‚Üí</button>
    <p class="setup-note">üîí Sua chave fica salva apenas no seu navegador e nunca √© enviada para nossos servidores. Uso gratuito com limite de 1.500 consultas/dia.</p>
  </div>
</div>

<div id="app">
  <header class="header">
    <div class="header-inner">
      <div class="logo">
        <div class="logo-mark">Ar</div>
        <div class="logo-text">
          <h1>ArchiAgent</h1>
          <span>Assistente Inteligente para Arquitetos</span>
        </div>
      </div>
      <div class="header-right">
        <span class="api-status">‚úì API Conectada</span>
        <button class="btn-change-key" onclick="changeKey()">Trocar Chave</button>
      </div>
    </div>
  </header>
  <main class="main">
    <nav class="agents-nav">
      <div class="agent-tab active" onclick="switchAgent('proposal')">
        <span class="agent-icon">üèõÔ∏è</span>
        <div class="agent-name">Proposta</div>
        <div class="agent-desc">Propostas comerciais e honor√°rios</div>
      </div>
      <div class="agent-tab" onclick="switchAgent('memorial')">
        <span class="agent-icon">üìê</span>
        <div class="agent-name">Memorial</div>
        <div class="agent-desc">Memoriais descritivos e especifica√ß√µes</div>
      </div>
      <div class="agent-tab" onclick="switchAgent('presentation')">
        <span class="agent-icon">üé®</span>
        <div class="agent-name">Apresenta√ß√£o</div>
        <div class="agent-desc">Narrativas e textos de projeto</div>
      </div>
      <div class="agent-tab" onclick="switchAgent('permit')">
        <span class="agent-icon">üìã</span>
        <div class="agent-name">Aprova√ß√£o</div>
        <div class="agent-desc">Documenta√ß√£o para prefeitura</div>
      </div>
    </nav>
    <div class="panel agent-panel active" id="panel-proposal">
      <div class="form-card">
        <h2>Agente de Propostas</h2>
        <p class="subtitle">Propostas comerciais e contratos de honor√°rios conforme o CAU/BR</p>
        <div class="divider"></div>
        <div class="form-group"><label>Tipo de Projeto</label><select id="pr-tipo"><option value="">Selecione...</option><option>Resid√™ncia Unifamiliar</option><option>Resid√™ncia Multifamiliar</option><option>Projeto Comercial</option><option>Projeto Industrial</option><option>Reforma e Amplia√ß√£o</option><option>Interiores</option><option>Projeto Institucional</option><option>Urbanismo e Paisagismo</option></select></div>
        <div class="form-group"><label>Nome do Cliente</label><input type="text" id="pr-cliente" placeholder="Ex: Jo√£o e Maria Silva" /></div>
        <div class="form-group"><label>Localiza√ß√£o</label><input type="text" id="pr-local" placeholder="Ex: Campina Grande/PB" /></div>
        <div class="form-group"><label>√Årea Estimada (m¬≤)</label><input type="text" id="pr-area" placeholder="Ex: 180 m¬≤" /></div>
        <div class="form-group"><label>Escopo dos Servi√ßos</label><textarea id="pr-escopo" placeholder="Ex: Projeto arquitet√¥nico completo, aprova√ß√£o em prefeitura, acompanhamento de obra..."></textarea></div>
        <div class="form-group"><label>Prazo Estimado</label><input type="text" id="pr-prazo" placeholder="Ex: 60 dias para projeto executivo" /></div>
        <button class="btn-generate" onclick="generate('proposal')">üèõÔ∏è Gerar Proposta</button>
      </div>
      <div class="result-card" id="result-proposal"><div class="result-placeholder"><div class="placeholder-icon">üèõÔ∏è</div><p>A proposta comercial ser√°<br>exibida aqui ap√≥s a gera√ß√£o</p></div></div>
    </div>
    <div class="panel agent-panel" id="panel-memorial">
      <div class="form-card">
        <h2>Agente de Memorial</h2>
        <p class="subtitle">Memoriais descritivos e especifica√ß√µes t√©cnicas conforme ABNT</p>
        <div class="divider"></div>
        <div class="form-group"><label>Tipo de Projeto</label><select id="me-tipo"><option value="">Selecione...</option><option>Resid√™ncia Unifamiliar</option><option>Edif√≠cio Residencial</option><option>Estabelecimento Comercial</option><option>Galp√£o Industrial</option><option>Escola / Creche</option><option>Reforma</option></select></div>
        <div class="form-group"><label>Localiza√ß√£o e Zoneamento</label><input type="text" id="me-local" placeholder="Ex: Zona Residencial R2, Campina Grande/PB" /></div>
        <div class="form-group"><label>√Årea Total Constru√≠da</label><input type="text" id="me-area" placeholder="Ex: 220 m¬≤" /></div>
        <div class="form-group"><label>Sistema Construtivo</label><select id="me-sistema"><option value="">Selecione...</option><option>Alvenaria convencional</option><option>Estrutura met√°lica</option><option>Concreto armado</option><option>Steel frame</option><option>Wood frame</option><option>Alvenaria estrutural</option></select></div>
        <div class="form-group"><label>Acabamentos e Materiais</label><textarea id="me-materiais" placeholder="Ex: Piso porcelanato 60x60, paredes em gesso liso, cobertura em telha cer√¢mica..."></textarea></div>
        <button class="btn-generate" onclick="generate('memorial')">üìê Gerar Memorial</button>
      </div>
      <div class="result-card" id="result-memorial"><div class="result-placeholder"><div class="placeholder-icon">üìê</div><p>O memorial descritivo ser√°<br>exibido aqui ap√≥s a gera√ß√£o</p></div></div>
    </div>
    <div class="panel agent-panel" id="panel-presentation">
      <div class="form-card">
        <h2>Agente de Apresenta√ß√£o</h2>
        <p class="subtitle">Narrativas de projeto e textos para apresenta√ß√£o ao cliente</p>
        <div class="divider"></div>
        <div class="form-group"><label>Tipo de Projeto</label><select id="ap-tipo"><option value="">Selecione...</option><option>Resid√™ncia contempor√¢nea</option><option>Casa de campo / s√≠tio</option><option>Apartamento</option><option>Escrit√≥rio / Coworking</option><option>Restaurante / Caf√©</option><option>Loja / Showroom</option><option>Espa√ßo cultural</option></select></div>
        <div class="form-group"><label>Conceito do Projeto</label><textarea id="ap-conceito" placeholder="Ex: Casa que integra interior e exterior, com √™nfase na luz natural e ventila√ß√£o cruzada..."></textarea></div>
        <div class="form-group"><label>Diferenciais do Projeto</label><textarea id="ap-diferenciais" placeholder="Ex: P√°tio central, materiais naturais, varanda integrada √† sala..." style="min-height:80px;"></textarea></div>
        <div class="form-group"><label>P√∫blico / Cliente</label><input type="text" id="ap-publico" placeholder="Ex: Casal jovem com dois filhos, estilo de vida ativo" /></div>
        <button class="btn-generate" onclick="generate('presentation')">üé® Gerar Apresenta√ß√£o</button>
      </div>
      <div class="result-card" id="result-presentation"><div class="result-placeholder"><div class="placeholder-icon">üé®</div><p>O texto de apresenta√ß√£o ser√°<br>exibido aqui ap√≥s a gera√ß√£o</p></div></div>
    </div>
    <div class="panel agent-panel" id="panel-permit">
      <div class="form-card">
        <h2>Agente de Aprova√ß√£o</h2>
        <p class="subtitle">Documenta√ß√£o para aprova√ß√£o de projetos na prefeitura</p>
        <div class="divider"></div>
        <div class="form-group"><label>Munic√≠pio</label><input type="text" id="pe-municipio" placeholder="Ex: Campina Grande/PB" /></div>
        <div class="form-group"><label>Tipo de Projeto</label><select id="pe-tipo"><option value="">Selecione...</option><option>Constru√ß√£o nova residencial</option><option>Constru√ß√£o nova comercial</option><option>Reforma com amplia√ß√£o</option><option>Reforma sem amplia√ß√£o</option><option>Regulariza√ß√£o de obra</option><option>Demoli√ß√£o</option></select></div>
        <div class="form-group"><label>Dados do Lote</label><input type="text" id="pe-lote" placeholder="Ex: Lote 10, Quadra 5, √Årea 360 m¬≤, Testada 12m" /></div>
        <div class="form-group"><label>√Årea Constru√≠da</label><input type="text" id="pe-area" placeholder="Ex: 180 m¬≤ ‚Äî T√©rreo + Superior" /></div>
        <div class="form-group"><label>Zoneamento</label><input type="text" id="pe-zoneamento" placeholder="Ex: Zona Residencial R2" /></div>
        <div class="form-group"><label>Observa√ß√µes Especiais</label><textarea id="pe-obs" placeholder="Ex: Terreno em aclive, APP pr√≥xima, im√≥vel tombado..." style="min-height:80px;"></textarea></div>
        <button class="btn-generate" onclick="generate('permit')">üìã Gerar Documenta√ß√£o</button>
      </div>
      <div class="result-card" id="result-permit"><div class="result-placeholder"><div class="placeholder-icon">üìã</div><p>A documenta√ß√£o para aprova√ß√£o<br>ser√° exibida aqui ap√≥s a gera√ß√£o</p></div></div>
    </div>
  </main>
  <footer class="footer">ArchiAgent ¬∑ Assistente Inteligente para Arquitetos ¬∑ Desenvolvido para arquitetos brasileiros</footer>
</div>

<script>
  let GEMINI_KEY = '';
  const agents = ['proposal', 'memorial', 'presentation', 'permit'];

  function activateApp() {
    const key = document.getElementById('api-key-input').value.trim();
    if (!key.startsWith('AIza') || key.length < 30) {
      document.getElementById('setup-error').style.display = 'block';
      return;
    }
    GEMINI_KEY = key;
    sessionStorage.setItem('archiagent_key', key);
    document.getElementById('setup-screen').style.display = 'none';
    document.getElementById('app').style.display = 'block';
  }

  function changeKey() {
    sessionStorage.removeItem('archiagent_key');
    GEMINI_KEY = '';
    document.getElementById('api-key-input').value = '';
    document.getElementById('setup-error').style.display = 'none';
    document.getElementById('setup-screen').style.display = 'flex';
    document.getElementById('app').style.display = 'none';
  }

  window.onload = function() {
    const saved = sessionStorage.getItem('archiagent_key');
    if (saved) {
      GEMINI_KEY = saved;
      document.getElementById('setup-screen').style.display = 'none';
      document.getElementById('app').style.display = 'block';
    }
    document.getElementById('api-key-input').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') activateApp();
    });
  };

  function switchAgent(name) {
    agents.forEach((a, i) => {
      document.querySelectorAll('.agent-tab')[i].classList.remove('active');
      document.getElementById('panel-' + a).classList.remove('active');
    });
    const idx = agents.indexOf(name);
    document.querySelectorAll('.agent-tab')[idx].classList.add('active');
    document.getElementById('panel-' + name).classList.add('active');
  }

  function buildPrompt(type) {
    if (type === 'proposal') return 'Voc√™ √© um especialista em arquitetura no Brasil. Elabore uma proposta comercial completa e profissional em portugu√™s.\n\nTipo: ' + document.getElementById('pr-tipo').value + '\nCliente: ' + document.getElementById('pr-cliente').value + '\nLocaliza√ß√£o: ' + document.getElementById('pr-local').value + '\n√Årea: ' + document.getElementById('pr-area').value + '\nEscopo: ' + document.getElementById('pr-escopo').value + '\nPrazo: ' + document.getElementById('pr-prazo').value + '\n\nInclua: apresenta√ß√£o profissional, escopo detalhado, etapas do projeto, cronograma, honor√°rios baseados na tabela CAU/BR, condi√ß√µes de pagamento, validade e termos de contrato.';
    if (type === 'memorial') return 'Voc√™ √© um especialista em documenta√ß√£o t√©cnica de arquitetura no Brasil. Elabore um memorial descritivo completo conforme normas ABNT em portugu√™s.\n\nTipo: ' + document.getElementById('me-tipo').value + '\nLocaliza√ß√£o: ' + document.getElementById('me-local').value + '\n√Årea: ' + document.getElementById('me-area').value + '\nSistema: ' + document.getElementById('me-sistema').value + '\nMateriais: ' + document.getElementById('me-materiais').value + '\n\nInclua: descri√ß√£o geral, implanta√ß√£o, sistema estrutural, instala√ß√µes el√©tricas e hidr√°ulicas, acabamentos, acessibilidade (NBR 9050), seguran√ßa contra inc√™ndio e normas aplic√°veis.';
    if (type === 'presentation') return 'Voc√™ √© um especialista em comunica√ß√£o de arquitetura no Brasil. Crie textos de apresenta√ß√£o profissionais e envolventes em portugu√™s.\n\nTipo: ' + document.getElementById('ap-tipo').value + '\nConceito: ' + document.getElementById('ap-conceito').value + '\nDiferenciais: ' + document.getElementById('ap-diferenciais').value + '\nCliente/P√∫blico: ' + document.getElementById('ap-publico').value + '\n\nCrie: texto conceitual (2-3 par√°grafos), descri√ß√£o dos ambientes principais, aspectos de sustentabilidade e inova√ß√£o, benef√≠cios para o cliente, texto para prancha de apresenta√ß√£o e sugest√£o de legenda para Instagram/Behance.';
    if (type === 'permit') return 'Voc√™ √© um especialista em aprova√ß√£o de projetos em prefeituras brasileiras. Prepare a documenta√ß√£o completa em portugu√™s.\n\nMunic√≠pio: ' + document.getElementById('pe-municipio').value + '\nTipo: ' + document.getElementById('pe-tipo').value + '\nLote: ' + document.getElementById('pe-lote').value + '\n√Årea Constru√≠da: ' + document.getElementById('pe-area').value + '\nZoneamento: ' + document.getElementById('pe-zoneamento').value + '\nObserva√ß√µes: ' + document.getElementById('pe-obs').value + '\n\nGere: requerimento formal dirigido √† prefeitura, checklist completo de documentos necess√°rios, quadro de √°reas conforme NBR 12721, verifica√ß√£o de par√¢metros urban√≠sticos e carta de encaminhamento formal.';
  }

  async function generate(type) {
    const resultCard = document.getElementById('result-' + type);
    const btn = document.querySelector('#panel-' + type + ' .btn-generate');
    resultCard.innerHTML = '<div class="loading"><div class="loading-bars"><div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div></div><p>Processando com intelig√™ncia artificial...</p></div>';
    btn.disabled = true;
    try {
      const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=' + GEMINI_KEY, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: buildPrompt(type) }] }], generationConfig: { temperature: 0.7, maxOutputTokens: 4000 } })
      });
      const data = await response.json();
      if (data.error) throw new Error(data.error.message);
      const text = data.candidates[0].content.parts[0].text;
      const labels = { proposal: 'Proposta Comercial Gerada', memorial: 'Memorial Descritivo Gerado', presentation: 'Texto de Apresenta√ß√£o Gerado', permit: 'Documenta√ß√£o para Aprova√ß√£o Gerada' };
      resultCard.innerHTML = '<div class="result-header"><h3>' + labels[type] + '</h3><div class="result-actions"><button class="btn-action" onclick="copyResult(\'' + type + '\')">Copiar</button><button class="btn-action" onclick="downloadResult(\'' + type + '\')">Baixar .txt</button></div></div><div class="divider"></div><div class="result-content" id="content-' + type + '">' + text + '</div>';
    } catch (err) {
      const msg = err.message.includes('API_KEY') ? 'Chave de API inv√°lida ou expirada. Clique em "Trocar Chave" para inserir uma nova.' : err.message;
      resultCard.innerHTML = '<div class="result-placeholder"><div class="placeholder-icon">‚ö†Ô∏è</div><p>' + msg + '</p></div>';
    } finally { btn.disabled = false; }
  }

  function copyResult(type) {
    const c = document.getElementById('content-' + type);
    if (c) { navigator.clipboard.writeText(c.innerText); alert('‚úì Texto copiado!'); }
  }

  function downloadResult(type) {
    const c = document.getElementById('content-' + type);
    if (!c) return;
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([c.innerText], { type: 'text/plain;charset=utf-8' }));
    a.download = 'archiagent-' + type + '-' + Date.now() + '.txt';
    a.click();
  }
</script>
</body>
</html>